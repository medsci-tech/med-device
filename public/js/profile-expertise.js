webpackJsonp([3],{15:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e(0),a=e.n(i);a()(function(){function t(t,n){a.a.ajax({url:"/get-hospital",type:"post",data:{province:t,city:n}}).then(function(t){if(1!==t.status)return void sweetAlert(t.message);var n=a()("#panel2 .items");n.children(".clear").remove();for(var e=t.data,i=0;i<e.length;i++){var s=e[i],c=a()('<div class="item clear" data-json='+JSON.stringify(s)+'><span class="name">'+s.hospital+"</span></div>"),o=a()('<input type="checkbox">').appendTo(c);c.click(function(){a()(this).children("input").click()}),o.click(function(){a()(this).click()}),c.appendTo(n)}})}function n(n,e){var i=a()(".city .drop-item");i.empty();for(var s=0;s<n.length;s++)if(n[s].name===e){for(var c=n[s].cities,o=0;o<c.length;o++)a()('<div data-prov="'+e+'">'+c[o].name+"</div>").addClass("item").click(function(){var n=a()(this).text();a()(".city span").text(n),h=n,t(a()(this).data("prov"),n)}).appendTo(i);break}}function e(t){if(0===a()("#item-container2 .inner").length)return!1;var n=!1;return a()("#item-container2 .inner").each(function(){a()(this).text()===t&&(n=!0)}),n}function i(t,n){this.json=t,this.data=this.json.map(function(t){return t.name}),this.index=n,this.panel=a()(".panel").eq(n),this.container=a()(".item-container").eq(n),this.btn_choose=a()(".btn-choose").eq(n),this.btn_panel=a()(".btn-panel").eq(n),this.chosen=[];for(var e=[],i=[],s=0;s<this.data.length;s++){var c=a()('<div class="item"><span>'+this.data[s]+"</span></div>").appendTo(this.panel),o=a()('<span class="icon"><span class="icon2"></span></span>'),p=a()('<div class="item" data-json='+JSON.stringify(this.json[s])+'><span class="inner">'+this.data[s]+"</span></div>").append(o).appendTo(this.container);e.push(c),i.push(p),c.on("click",function(t){return function(){a()(this).toggleClass("item-chosen"),i[t].toggleClass("item-chosen")}}(s));var h=this;o.on("click",function(t){return function(){e[t].toggleClass("item-chosen"),i[t].toggleClass("item-chosen"),r.push({id:0===h.index?h.json[t].depart_id:h.json[t].service_type_id,type:0===h.index?"depart":"service"})}}(s))}var h=this;this.btn_choose.on("click",function(){h.panel.fadeIn(),a()(".shielder").show()})}function s(t){return a.a.ajax({url:"/personal/del-expertise",type:"post",data:t}).done(function(t){1!==t.status&&sweetAlert(t.message)})}var c,o,r=[];a.a.ajax({url:"/get-depart",success:function(t){c=t;new i(c,0)}}),a.a.ajax({url:"/get-service",success:function(t){o=t;new i(o,2)}});var p="",h="";a.a.getJSON("/json/loc.json").then(function(t){t=t;var e=a()('<div class="item" id="byuser"><span class="name"></span></div>'),i=a()('<input type="checkbox">').appendTo(e);e.click(function(){a()(this).children("input").click()}),i.click(function(){a()(this).click()}),e.appendTo(a()("#panel2 .items")).hide();for(var s=0;s<t.length;s++)a()("<div>"+t[s].name+"</div>").addClass("item").click(function(){var e=a()(this).text();a()(".province span").text(e),a()(".city span").text(""),p=e,n(t,e)}).appendTo(a()(".province .drop-item"))}),a()(".search-box").on("keyup",function(){var t=a()(this).val();a()(".items .item").each(function(){-1===a()(this).children(".name").text().indexOf(t)?(a()(this).hide(),0!==a()(this).children("input").length&&(a()(this).children("input")[0].checked=!1)):a()(this).show()}),a()("#byuser .name").text(t),t?a()("#byuser").show():a()("#byuser").hide()}),a()(".province,.city").click(function(t){t.stopPropagation(),a()(this).children(".drop-item").slideToggle(160)}),a()("body").click(function(){a()(".drop-item").slideUp(160)});var l=function(t){var n,e=a()('<span class="icon"><span class="icon2"></span></span>');n="string"==typeof t?a()('<div class="item" style="display:block"><span class="inner">'+t+"</span></div>").append(e).appendTo(a()("#item-container2")):a()('<div class="item" style="display:block" data-json='+JSON.stringify(t)+'><span class="inner">'+t.hospital+"</span></div>").append(e).appendTo(a()("#item-container2")),e.click(function(){n.remove(),r.push({id:t.id,type:"hospital"})})};a()("#panel2 .btn-panel").click(function(){for(var t=a()(".items .item"),n=0;n<t.length;n++){var i=t.eq(n);i.children("input")[0].checked&&!e(i.children(".name").text())&&l(i.data("json")?i.data("json"):i.children(".name").text())}}),a()("#hospital").click(function(){a()("#panel2").fadeIn(),a()(".shielder").show()}),a()(".panel img,.shielder,.btn-panel").on("click",function(){a()(".shielder,.panel").hide()}),a()("#submit").click(function(){for(var t=[],n=0;n<r.length;n++)t.push(s(r[n]));a.a.when(t).done(function(){var t=[],n=[],e=[];a()("#item-container2 .item").each(function(){a()(this).data("json")?t.push(a()(this).data("json")):t.push(a()(this).children(".inner").text())}),a()("#item-container1 .item").each(function(){a()(this).hasClass("item-chosen")&&n.push(a()(this).data("json"))}),a()("#item-container3 .item").each(function(){a()(this).hasClass("item-chosen")&&e.push(a()(this).data("json"))});var i={depart_ids:JSON.stringify(n.map(function(t){return{depart_id:t.depart_id}})),service_type_ids:JSON.stringify(e.map(function(t){return{service_type_id:t.service_type_id}})),hospitals:JSON.stringify(t.map(function(t){return"string"==typeof t?{city:"",hospital:t,province:""}:{city:t.city,hospital:t.hospital,province:t.province}}))};a.a.ajax({url:"/personal/expertise",method:"POST",data:i,success:function(t){1===t.status?swal({title:"",html:!0,text:'修改成功! <a href="/">前往首页</a>',type:"success",showConfirmButton:!1}):sweetAlert(t.message)}})})});a.a.ajax({url:"/personal/get-hospital"}).then(function(t){for(var n=0;n<t.length;n++)l(t[n])}),a.a.ajax({url:"/personal/get-depart"}).then(function(t){for(var n=0;n<t.length;n++)a()("#item-container1 .item").each(function(){a()(this).data("json").name===t[n].name&&a()(this).addClass("item-chosen")}),a()("#panel1 .item").each(function(){a()(this).children("span").text()===t[n].name&&a()(this).addClass("item-chosen")})}),a.a.ajax({url:"/personal/get-service"}).then(function(t){for(var n=0;n<t.length;n++)a()("#item-container3 .item").each(function(){a()(this).data("json").name===t[n].name&&a()(this).addClass("item-chosen")}),a()("#panel3 .item").each(function(){a()(this).children("span").text()===t[n].name&&a()(this).addClass("item-chosen")})})})},66:function(t,n,e){t.exports=e(15)}},[66]);